function str = to_html (obj, html_title)
% TO_HTML  Export 'cdata' to rich HTML markup (MathJax, jQuery, dataTables).

% Copyright 2018-2019 Kai T. Ohlhus (kai.ohlhus@tuhh.de)

% Ensure string entries.
cdata = obj.to_cell_strings ().cdata_view;

thead = sprintf ('  <th>%s</th>\n', strjoin (cdata(1,:), '</th>\n  <th>'));
thead = sprintf ('<thead>\n<tr>\n%s</tr>\n</thead>\n', thead);
for i = 2:size (cdata, 1)
  cdata{i,1} = sprintf ('  <td>%s</td>\n', strjoin (cdata(i,:), ...
    '</td>\n  <td>'));
end
cdata = cdata(2:end,1);
str = sprintf ('<tr>\n%s</tr>\n', strjoin (cdata, '</tr>\n<tr>\n'));
str = sprintf ('<tbody>\n%s</tbody>\n', str);
str = sprintf ( ...
  '<table id="main_tab" class="display" style="width:100%%">\n%s%s</table>\n', ...
  thead, str);

if (nargin == 1)
html_title = 'VSDP Benchmark Results';
end

datatables_url = ...
  'https://cdn.datatables.net/v/dt/jq-3.3.1/dt-1.10.18/fh-3.1.4/sl-1.3.0/datatables.min';

header = strjoin ({ ...
  '<!DOCTYPE html>', ...
  '<html>', ...
  '<head>', ...
  ['<title>', html_title, '</title>'], ...
  '<meta charset=''UTF-8''>', ...
  ['<link   rel="stylesheet"      href="', datatables_url, '.css">'], ...
  ['<script type="text/javascript" src="', datatables_url, '.js"></script>'], ...
  '<script type="text/x-mathjax-config">', ...
  'MathJax.Hub.Config({', ...
  'tex2jax: { inlineMath: [[''$'',''$''], [''\\('',''\\)'']] },', ...
  '});', ...
  '</script>', ...
  '<script type="text/javascript" async ', ...
  'src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">', ...
  '</script>', ...
  '</head>', ...
  '<body>'}, '\n');
footer = strjoin ({ ...
  '<script type=''text/javascript''>$(document).ready( function () {', ...
  '$(''#main_tab'').DataTable( {', ...
  '  select: true,', ...
  '  fixedHeader: true,', ...
  '  "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]]', ...
  '  } );', ...
  '} );', ...
  '</script>', ...
  '</body>', ...
  '</html>'}, '\n');

str = sprintf ('%s\n%s%s\n', header, str, footer);
end
