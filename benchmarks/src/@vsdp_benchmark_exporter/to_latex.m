function str = to_latex (obj)
% TO_LATEX  Export 'obj.cdata_view' to LaTeX markup (longtable environment).

% Copyright 2018-2019 Kai T. Ohlhus (kai.ohlhus@tuhh.de)

% Ensure string entries.
cdata = obj.to_cell_strings ().cdata_view;

thead = strjoin (cdata(1,:), '\n& ');
thead = sprintf ('{%s}\n\\toprule\n%s \\\\\n\\toprule\n', ...
  repmat('c', 1, size (cdata(1,:), 2)), thead);
for i = 2:size (cdata, 1)
  cdata{i,1} = sprintf ('%s \\\\', strjoin (cdata(i,:), '\n& '));
end
cdata = cdata(2:end,1);
str = sprintf ('%s\n', strjoin (cdata, '\n'));

header = strjoin ({ ...
  '\documentclass{article}', ...
  '\usepackage{booktabs}', ...
  '\usepackage{longtable}', ...
  '\usepackage{mathtools}', ...
  '', ...
  '\begin{document}', ...
  '\begin{longtable}'}, '\n');
footer = strjoin ({ ...
  '\bottomrule', ...
  '\end{longtable}', ...
  '\end{document}'}, '\n');

str = sprintf ('%s%s%s%s', header, thead, str, footer);
end
